//****************************************************************************************
//
// SPH Code
//
// created	89/03 By R. Fatehi
// changed		89/03 By Fatehi
// Last change	97/11 By Nikooei
//****************************************************************************************


#include "tensors5.h"

Tensor5 & Tensor5::operator+=(const Tensor5& p)
{
	ets[0][0][0][0][0]+=p.ets[0][0][0][0][0];
	ets[0][0][0][0][1]+=p.ets[0][0][0][0][1];
	ets[0][0][0][1][0]+=p.ets[0][0][0][1][0];
	ets[0][0][0][1][1]+=p.ets[0][0][0][1][1];
	ets[0][0][1][0][0]+=p.ets[0][0][1][0][0];
	ets[0][0][1][0][1]+=p.ets[0][0][1][0][1];
	ets[0][0][1][1][0]+=p.ets[0][0][1][1][0];
	ets[0][0][1][1][1]+=p.ets[0][0][1][1][1];
	ets[0][1][0][0][0]+=p.ets[0][1][0][0][0];
	ets[0][1][0][0][1]+=p.ets[0][1][0][0][1];
	ets[0][1][0][1][0]+=p.ets[0][1][0][1][0];
	ets[0][1][0][1][1]+=p.ets[0][1][0][1][1];
	ets[0][1][1][0][0]+=p.ets[0][1][1][0][0];
	ets[0][1][1][0][1]+=p.ets[0][1][1][0][1];
	ets[0][1][1][1][0]+=p.ets[0][1][1][1][0];
	ets[0][1][1][1][1]+=p.ets[0][1][1][1][1];
	ets[1][0][0][0][0]+=p.ets[1][0][0][0][0];
	ets[1][0][0][0][1]+=p.ets[1][0][0][0][1];
	ets[1][0][0][1][0]+=p.ets[1][0][0][1][0];
	ets[1][0][0][1][1]+=p.ets[1][0][0][1][1];
	ets[1][0][1][0][0]+=p.ets[1][0][1][0][0];
	ets[1][0][1][0][1]+=p.ets[1][0][1][0][1];
	ets[1][0][1][1][0]+=p.ets[1][0][1][1][0];
	ets[1][0][1][1][1]+=p.ets[1][0][1][1][1];
	ets[1][1][0][0][0]+=p.ets[1][1][0][0][0];
	ets[1][1][0][0][1]+=p.ets[1][1][0][0][1];
	ets[1][1][0][1][0]+=p.ets[1][1][0][1][0];
	ets[1][1][0][1][1]+=p.ets[1][1][0][1][1];
	ets[1][1][1][0][0]+=p.ets[1][1][1][0][0];
	ets[1][1][1][0][1]+=p.ets[1][1][1][0][1];
	ets[1][1][1][1][0]+=p.ets[1][1][1][1][0];
	ets[1][1][1][1][1]+=p.ets[1][1][1][1][1];

	return *this;
}

Tensor5 & Tensor5::operator-=(const Tensor5& p)
{
	ets[0][0][0][0][0]-=p.ets[0][0][0][0][0];
	ets[0][0][0][0][1]-=p.ets[0][0][0][0][1];
	ets[0][0][0][1][0]-=p.ets[0][0][0][1][0];
	ets[0][0][0][1][1]-=p.ets[0][0][0][1][1];
	ets[0][0][1][0][0]-=p.ets[0][0][1][0][0];
	ets[0][0][1][0][1]-=p.ets[0][0][1][0][1];
	ets[0][0][1][1][0]-=p.ets[0][0][1][1][0];
	ets[0][0][1][1][1]-=p.ets[0][0][1][1][1];
	ets[0][1][0][0][0]-=p.ets[0][1][0][0][0];
	ets[0][1][0][0][1]-=p.ets[0][1][0][0][1];
	ets[0][1][0][1][0]-=p.ets[0][1][0][1][0];
	ets[0][1][0][1][1]-=p.ets[0][1][0][1][1];
	ets[0][1][1][0][0]-=p.ets[0][1][1][0][0];
	ets[0][1][1][0][1]-=p.ets[0][1][1][0][1];
	ets[0][1][1][1][0]-=p.ets[0][1][1][1][0];
	ets[0][1][1][1][1]-=p.ets[0][1][1][1][1];
	ets[1][0][0][0][0]-=p.ets[1][0][0][0][0];
	ets[1][0][0][0][1]-=p.ets[1][0][0][0][1];
	ets[1][0][0][1][0]-=p.ets[1][0][0][1][0];
	ets[1][0][0][1][1]-=p.ets[1][0][0][1][1];
	ets[1][0][1][0][0]-=p.ets[1][0][1][0][0];
	ets[1][0][1][0][1]-=p.ets[1][0][1][0][1];
	ets[1][0][1][1][0]-=p.ets[1][0][1][1][0];
	ets[1][0][1][1][1]-=p.ets[1][0][1][1][1];
	ets[1][1][0][0][0]-=p.ets[1][1][0][0][0];
	ets[1][1][0][0][1]-=p.ets[1][1][0][0][1];
	ets[1][1][0][1][0]-=p.ets[1][1][0][1][0];
	ets[1][1][0][1][1]-=p.ets[1][1][0][1][1];
	ets[1][1][1][0][0]-=p.ets[1][1][1][0][0];
	ets[1][1][1][0][1]-=p.ets[1][1][1][0][1];
	ets[1][1][1][1][0]-=p.ets[1][1][1][1][0];
	ets[1][1][1][1][1]-=p.ets[1][1][1][1][1];

	return *this;
}

Tensor5 operator+(const Tensor5 & p)
{
	return p;
}

Tensor5 operator-(const Tensor5& p)
{
	return Tensor5() - p; //a.r: changed to default constructor to compatible 2D/3D versions
}

Tensor5 operator+(const Tensor5& p1, const Tensor5 & p2)
{
	Tensor5 sum = p1;
	sum += p2;
	return sum;
}

Tensor5 operator-(const Tensor5& p1, const Tensor5& p2)
{
	Tensor5 sum = p1;
	sum -= p2;
	return sum;
}

Tensor5 operator*(const double scalar, const Tensor5 & p)
{
	Tensor5 tm;
	tm.ets[0][0][0][0][0]=scalar*p.ets[0][0][0][0][0];
	tm.ets[0][0][0][0][1]=scalar*p.ets[0][0][0][0][1];
	tm.ets[0][0][0][1][0]=scalar*p.ets[0][0][0][1][0];
	tm.ets[0][0][0][1][1]=scalar*p.ets[0][0][0][1][1];
	tm.ets[0][0][1][0][0]=scalar*p.ets[0][0][1][0][0];
	tm.ets[0][0][1][0][1]=scalar*p.ets[0][0][1][0][1];
	tm.ets[0][0][1][1][0]=scalar*p.ets[0][0][1][1][0];
	tm.ets[0][0][1][1][1]=scalar*p.ets[0][0][1][1][1];
	tm.ets[0][1][0][0][0]=scalar*p.ets[0][1][0][0][0];
	tm.ets[0][1][0][0][1]=scalar*p.ets[0][1][0][0][1];
	tm.ets[0][1][0][1][0]=scalar*p.ets[0][1][0][1][0];
	tm.ets[0][1][0][1][1]=scalar*p.ets[0][1][0][1][1];
	tm.ets[0][1][1][0][0]=scalar*p.ets[0][1][1][0][0];
	tm.ets[0][1][1][0][1]=scalar*p.ets[0][1][1][0][1];
	tm.ets[0][1][1][1][0]=scalar*p.ets[0][1][1][1][0];
	tm.ets[0][1][1][1][1]=scalar*p.ets[0][1][1][1][1];
	tm.ets[1][0][0][0][0]=scalar*p.ets[1][0][0][0][0];
	tm.ets[1][0][0][0][1]=scalar*p.ets[1][0][0][0][1];
	tm.ets[1][0][0][1][0]=scalar*p.ets[1][0][0][1][0];
	tm.ets[1][0][0][1][1]=scalar*p.ets[1][0][0][1][1];
	tm.ets[1][0][1][0][0]=scalar*p.ets[1][0][1][0][0];
	tm.ets[1][0][1][0][1]=scalar*p.ets[1][0][1][0][1];
	tm.ets[1][0][1][1][0]=scalar*p.ets[1][0][1][1][0];
	tm.ets[1][0][1][1][1]=scalar*p.ets[1][0][1][1][1];
	tm.ets[1][1][0][0][0]=scalar*p.ets[1][1][0][0][0];
	tm.ets[1][1][0][0][1]=scalar*p.ets[1][1][0][0][1];
	tm.ets[1][1][0][1][0]=scalar*p.ets[1][1][0][1][0];
	tm.ets[1][1][0][1][1]=scalar*p.ets[1][1][0][1][1];
	tm.ets[1][1][1][0][0]=scalar*p.ets[1][1][1][0][0];
	tm.ets[1][1][1][0][1]=scalar*p.ets[1][1][1][0][1];
	tm.ets[1][1][1][1][0]=scalar*p.ets[1][1][1][1][0];
	tm.ets[1][1][1][1][1]=scalar*p.ets[1][1][1][1][1];

	return tm;
}

inline Tensor5 operator*(const Tensor5 & p, const double scalar)
{
	return scalar*p;
}



Tensor5 operator*(const Tensor4 &t4 , const Tensor3 &t3)
{
	Tensor5 t5;

	t5.ets[1][0][0][0][1]=t4.ets[1][0][0][0]*t3.ets[0][0][1]+t4.ets[1][0][0][1]*t3.ets[1][0][1];
	t5.ets[1][0][0][1][1]=t4.ets[1][0][0][0]*t3.ets[0][1][1]+t4.ets[1][0][0][1]*t3.ets[1][1][1];
	t5.ets[1][0][1][0][1]=t4.ets[1][0][1][0]*t3.ets[0][0][1]+t4.ets[1][0][1][1]*t3.ets[1][0][1];
	t5.ets[1][0][1][1][1]=t4.ets[1][0][1][0]*t3.ets[0][1][1]+t4.ets[1][0][1][1]*t3.ets[1][1][1];

	t5.ets[1][1][0][0][1]=t4.ets[1][1][0][0]*t3.ets[0][0][1]+t4.ets[1][1][0][1]*t3.ets[1][0][1];
	t5.ets[1][1][0][1][1]=t4.ets[1][1][0][0]*t3.ets[0][1][1]+t4.ets[1][1][0][1]*t3.ets[1][1][1];
	t5.ets[1][1][1][0][1]=t4.ets[1][1][1][0]*t3.ets[0][0][1]+t4.ets[1][1][1][1]*t3.ets[1][0][1];
	t5.ets[1][1][1][1][1]=t4.ets[1][1][1][0]*t3.ets[0][1][1]+t4.ets[1][1][1][1]*t3.ets[1][1][1];

	t5.ets[0][0][0][0][1]=t4.ets[0][0][0][0]*t3.ets[0][0][1]+t4.ets[0][0][0][1]*t3.ets[1][0][1];
	t5.ets[0][0][0][1][1]=t4.ets[0][0][0][0]*t3.ets[0][1][1]+t4.ets[0][0][0][1]*t3.ets[1][1][1];
	t5.ets[0][0][1][0][1]=t4.ets[0][0][1][0]*t3.ets[0][0][1]+t4.ets[0][0][1][1]*t3.ets[1][0][1];
	t5.ets[0][0][1][1][1]=t4.ets[0][0][1][0]*t3.ets[0][1][1]+t4.ets[0][0][1][1]*t3.ets[1][1][1];

	t5.ets[0][1][0][0][1]=t4.ets[0][1][0][0]*t3.ets[0][0][1]+t4.ets[0][1][0][1]*t3.ets[1][0][1];
	t5.ets[0][1][0][1][1]=t4.ets[0][1][0][0]*t3.ets[0][1][1]+t4.ets[0][1][0][1]*t3.ets[1][1][1];
	t5.ets[0][1][1][0][1]=t4.ets[0][1][1][0]*t3.ets[0][0][1]+t4.ets[0][1][1][1]*t3.ets[1][0][1];
	t5.ets[0][1][1][1][1]=t4.ets[0][1][1][0]*t3.ets[0][1][1]+t4.ets[0][1][1][1]*t3.ets[1][1][1];
/*--------------------------------------------------------------------------------*/
	t5.ets[1][0][0][0][0]=t4.ets[1][0][0][0]*t3.ets[0][0][0]+t4.ets[1][0][0][1]*t3.ets[1][0][0];
	t5.ets[1][0][0][1][0]=t4.ets[1][0][0][0]*t3.ets[0][1][0]+t4.ets[1][0][0][1]*t3.ets[1][1][0];
	t5.ets[1][0][1][0][0]=t4.ets[1][0][1][0]*t3.ets[0][0][0]+t4.ets[1][0][1][1]*t3.ets[1][0][0];
	t5.ets[1][0][1][1][0]=t4.ets[1][0][1][0]*t3.ets[0][1][0]+t4.ets[1][0][1][1]*t3.ets[1][1][0];

	t5.ets[1][1][0][0][0]=t4.ets[1][1][0][0]*t3.ets[0][0][0]+t4.ets[1][1][0][1]*t3.ets[1][0][0];
	t5.ets[1][1][0][1][0]=t4.ets[1][1][0][0]*t3.ets[0][1][0]+t4.ets[1][1][0][1]*t3.ets[1][1][0];
	t5.ets[1][1][1][0][0]=t4.ets[1][1][1][0]*t3.ets[0][0][0]+t4.ets[1][1][1][1]*t3.ets[1][0][0];
	t5.ets[1][1][1][1][0]=t4.ets[1][1][1][0]*t3.ets[0][1][0]+t4.ets[1][1][1][1]*t3.ets[1][1][0];

	t5.ets[0][0][0][0][0]=t4.ets[0][0][0][0]*t3.ets[0][0][0]+t4.ets[0][0][0][1]*t3.ets[1][0][0];
	t5.ets[0][0][0][1][0]=t4.ets[0][0][0][0]*t3.ets[0][1][0]+t4.ets[0][0][0][1]*t3.ets[1][1][0];
	t5.ets[0][0][1][0][0]=t4.ets[0][0][1][0]*t3.ets[0][0][0]+t4.ets[0][0][1][1]*t3.ets[1][0][0];
	t5.ets[0][0][1][1][0]=t4.ets[0][0][1][0]*t3.ets[0][1][0]+t4.ets[0][0][1][1]*t3.ets[1][1][0];

	t5.ets[0][1][0][0][0]=t4.ets[0][1][0][0]*t3.ets[0][0][0]+t4.ets[0][1][0][1]*t3.ets[1][0][0];
	t5.ets[0][1][0][1][0]=t4.ets[0][1][0][0]*t3.ets[0][1][0]+t4.ets[0][1][0][1]*t3.ets[1][1][0];
	t5.ets[0][1][1][0][0]=t4.ets[0][1][1][0]*t3.ets[0][0][0]+t4.ets[0][1][1][1]*t3.ets[1][0][0];
	t5.ets[0][1][1][1][0]=t4.ets[0][1][1][0]*t3.ets[0][1][0]+t4.ets[0][1][1][1]*t3.ets[1][1][0];

	return t5;
}
